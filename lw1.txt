中文摘要
 

以直播为代表的内容化战略，已经成为电商新的增长点，不仅成为电商平台和品牌方运营的核心工具，也带来更多的用户黏度和订单成交，目前电商平台的商品类目，业务，用户的增长，都来自于电商直播的模式。利用直播真实、互动、有趣的特点，通过专业化、电视化、品牌化的直播内容，打消消费者购买顾虑，提高商品转化。pgc模式：筛选具有专业领域视频制作能力的机构，替供应商制作用户感兴趣的有价值的、并能和电商关联的直播视频内容，一般以演播蓬内偏综艺形式体现。ugc模式：了解基本电商术语，具备较强的学习能力和数据分析能力的媒体机构，为供应商提供具有专业导购的红人和网络主播，单人进行直播互动与产品讲解
直播成为电商新的营销方式，主播将自己的私域粉丝集中在直播间中，粉丝在直播间中观看主播直播内容，并可以和其他直播间粉丝和主播交流，增加用户互动，也为商品的品牌商带来传播效应。

关键词：   电商平台； 直播； 带货                               





 目    录

引  言	1
1 、电商直播概述	2
1.1、电商直播概念和特点	2
1.2、电商直播技术及内容	2
2 、电商直播技术及内容现状和问题	3
2.1、电商直播玩法	3
2.2、直播延迟高	4
2.3、互动玩法与画面不同步：	4
3 、如何降低直播延迟和玩法画面不同步的建议	4
3.1、降低直播延迟高:	4
3.2、互动玩法与画面不同步	5
结  论	7
致  谢	8
XX老师在我完成本论文期间给予我无私的帮助和精心的指导。在此，特向他表示衷心的感谢……	8
参考文献	9
附  录 	11
附录A  设计程序清单
引  言
2020年开始的疫情线下场景的销售产生了较大的影响。在此种情况下，电商平台凭借直播技术在线上仍然开展商品销售活动。
人们的消费习惯产生了变化，社区中产生了内部群，私域流量被大众重视，由群主带货，由达人带货得到大力发展，运用直播技术可以让顾客能更了解自己需要的商品，并可以向主播或者卖家进行连麦沟通，了解商品更多信息。头部网红能带来大量的流量，并进行粉丝变现，而在大量直播平台兴起的时候，直播技术在电商平台的应用也越来越广泛。在这个过程中直播技术在电商平台的应用也出现了一些问题，如何解决这些问题，将有助电商平台更好的开展线上销售活动，并提升用户的购物体验。



1 、电商直播概述
1.1、电商直播概念和特点
视频直播服务是基于内容接入、cdn节点网络分发和分布式实时转码识别技术打造的音视频平台，提供推流SDK、推流服务端、转码服务、流管理、流监控、回放录制、消息通道等服务。

优势：
1、客户体验的角度
直播带货能让用户直观看到商品并且主播亲自上手试用，帮用户解答疑问和顾虑，也让商品的介绍更丰富和生动

2、效率的角度
直播带货改变了电子商务从拍照、上传、开卖的流程，直播带货能快速推广商品，客户能第一时间看到货物

3、成本角度
直播带货能够带来更轻量化、更高用户粘性、互动性、快速销售特点
1.2、电商直播技术及内容
工作原理：
通过摄像头将画面和语音推送到流媒体服务器，推送的画面视频通过CDN就近节点向各个边缘中心分发，保证链路的畅通和加速。
移动端的开播工具通过集成推流SDK达到推送功能。视频流推送至CDN节点后，可按预先设定对视频流进行录制、鉴别、转码，录制，安全审核处理。
处理完成的视频流再进行CDN内容分发网络下发至边缘节点。用户的设备的播放器可通过播放器SDK进行视屏流播放。
直播视频流除了转码还可以进行转录、切片，将录制好的回放视频进行二次分发和传播

详细步骤
1.采集：采集是播放环节中的第一环，iOS 系统因为软硬件种类不多，硬件适配性较好，所以比较简单。Android 则不同，市面上硬件机型非常多，难以做到一个库适配所有硬件。PC 端的采集也跟各种摄像头驱动有关，推荐使用目前市面上最好用的 PC 端开源免费软件 OBS。

2.处理：不光是美颜，很多其它的视频处理如模糊效果、水印等也都是在这个环节做。目前 iOS 端比较知名的是 GPUImage 这个库，提供了丰富端预处理效果，还可以基于这个库自己写算法实现更丰富端效果。Android 也有 GPUImage 这个库的移植，叫做 android-gpuimage。同时，Google 官方开源了一个伟大的库，覆盖了 Android 上面很多多媒体和图形图像相关的处理。

3.编码：编码主要难点有两个：1. 处理硬件兼容性问题。2. 在高 fps、低 bitrate 和音质画质之间找到平衡。iOS 端硬件兼容性较好，可以直接采用硬编。而 Android 的硬编的支持则难得多，需要支持各种硬件机型，推荐使用软编。

4.推流和传输：传输涉及到很多端：从主播端到服务端，从收流服务端到边缘节点，以及再从边缘节点到观众端。推流端和分发端理论上需要支持的并发用户数应该都是亿级的，不过毕竟产生内容的推流端在少数，和消费内容端播放端不是一个量级，但是他们对推流稳定性和速度的要求比播放端高很多，这涉及到所有播放端能否看到直播，以及直播端质量如何。借助 CDN 快速实现大规模的流分发，但是稳定高速的推流上传可能还需要自己做很多工作。

5.转码：为了让主播推上来的流适配各个平台端各种不同协议，需要在服务端做一些流处理工作，比如转码成不同格式支持不同协议如 RTMP、HLS 和 FLV，一路转多路流来适配各种不同的网络状况和不同分辨率的终端设备。

6.解码和渲染：解码和渲染，也即音视频的播放，目前 iOS 端的播放兼容性较好，在延迟可接受的情况下使用 HLS 协议是最好的选择，我们也提供了能够播放 RTMP 和 HLS 的播放器 SDK。Android 的硬件解码和编码一样也存在兼容性问题，目前比较好的开源播放器是基于 ffplay 的 ijkplayer。


7.直播场景化解决方案：互动系统（聊天室、礼物系统、点赞），除了整个直播流程的介绍之外，我们将围绕当下最火的直播场景如社交直播和游戏直播，介绍它背后的技术方案。这些技术方案不仅涉及到七牛这样的直播基础服务，还可能涉及到和场景相关的其它技术，如社交直播下的聊天、点赞和弹幕的支持
2 、电商直播技术及内容现状和问题
2.1、电商直播玩法
（1）聊天
私聊、聊天室、点赞、推送、黑名单等;

（2）礼物
普通礼物、豪华礼物、红包、排行榜、第三方充值、内购、礼物动态更新、提现等；

（3）直播列表
关注、热门、最新、分类直播用户列表等；

（4）自己直播
录制、推流、解码、播放、美颜、心跳、后台切换、主播对管理员操作、管理员对用户等；

（5）房间逻辑

创建房间、进入房间、退出房间、关闭房间、切换房间、房间管理员设置、房间用户列表等；

（6）用户逻辑
普通登陆、第三方登陆、注册、搜索、修改个人信息、关注列表、粉丝列表、忘记密码、查看个人信息、收入榜、关注和取关、检索等；

（7）观看直播
聊天信息、滚屏弹幕、礼物显示、加载界面等；

（8）统计
业务统计、第三方统计等；

（9）超级管理员
禁播、隐藏、审核等；
2.2、直播延迟高
直播行业大火，大家可以在日常生活中接触到各类直播，例如游戏直播、乐秀、在线教育、发布会等等。无论哪种类型的直
播，延时是直播过程中需要关注的一个重要的点。直播实现低延迟，是对大部分直播产品的要求，低延迟也是提升直播产品
用户体验最有效的一个方法，特别是对于互动直播、在线教育这一类产品来说。
2.3、互动玩法与画面不同步：
在直播应用的开发过程中，如果把主播端消息事件传递到观众端，一般会以Instant Messaging（即时通讯）的方式传递过去，但因为消息分发通道和直播通道是分开的，因此消息与直播音视频数据的同步性就会出现很多问题。
3 、如何降低直播延迟和玩法画面不同步的建议
3.1、降低直播延迟高:
视频直播主要涉及到采集、预处理、编码、传输、服务器转码、解码这样的流程。而延迟可以理解为几个关键延迟成分的集合：处理延迟、传输延迟和传播延迟。处理延迟是指系统对数据包报头进行分析和确定数据包被发送到哪里去所要花费的时间。传输延迟是指将包中的数据位传入线路所需要的时间。根据数据包的大小和带宽的不同而有所变化。但并不取决于传输线路的距离，而传播延迟是指数据包的第一个比特位从发送端到达接收端的时间。通常也被称为距离的延迟，受数据传输距离和传播速度的影响。

1、直播协议选择
目前国内比较常见的三种直播协议 RTMP、HLS、HTTP-FLV，下面来简单介绍下。RTMP 是专为流媒体开发的协议，对底层的优化比其它协议更加优秀，同时它 Adobe Flash 支持好，基本上所有的编码器（摄像头之类）都支持 RTMP 输出。现在 PC 市场巨大，PC 主要是 Windows，Windows 的浏览器基本上都支持 Flash。另外 RTMP 适合长时间播放，曾经有过测试，连续 100 万秒，即 10 天多连续播放没有出现问题。最后 RTMP 的延迟相对较低，一般延时在 1-3s 之间，一般的视频会议，互动式直播，完全是够用的。

当然 RTMP 并没有尽善尽美，它也有不足的地方。一方面是它是基于 TCP 传输，非公共端口，可能会被防火墙阻拦；另一方面，也是比较坑的一方面是 RTMP 为 Adobe 私有协议，很多设备无法播放，特别是在 iOS 端，需要使用第三方解码器才能播放。

HLS 是由苹果公司提出的基于 HTTP 的流媒体网络传输协议。是苹果公司 QuickTime X 和 iPhone 软件系统的一部分。主要应用于 iOS 设备，包含(iPhone, iPad, iPod touch) 以及 Mac OSX 提供音视频直播服务和录制内容（点播）等服务。它的工作原理是把整个流分成一个个小的基于 HTTP 的文件来下载，每次只下载一些。当媒体流正在播放时，客户端可以选择从许多不同的备用源中以不同的速率下载同样的资源，允许流媒体会话适应不同的数据速率。性能高，可以通过 CDN 进行网络分发。

而 HLS 的劣势也非常明显，首先 HLS 实时性差，延迟高，HLS 的延迟基本在 10s+ 以上。另外由于 HLS 请求的并不是完整的数据流，导致它产生文件碎片多。ts 切片较小，会造成海量小文件，对存储和缓存都有一定的挑战。

FLV是一种在网络上传输的流媒体数据存储容器格式。而我们所说的 HTTP-FLV 即将流媒体数据封装成 FLV 格式，然后通过 HTTP 协议传输给客户端。HTTP-FLV 能够好的穿透防火墙，它是基于 HTTP/80 传输，有效避免被防火墙拦截。另外，它可以通过 HTTP 302 跳转灵活调度/负载均衡，支持使用 HTTPS 加密传输，也能够兼容支持 Android，iOS 的移动端。FLV 也有一个缺点，由于它的传输特性，会让流媒体资源缓存在本地客户端，在保密性方面不够好。

在不同的直播场景中，选用合适的直播协议，能大大降低直播的延迟。


2、细节优化，减少延迟
智能调度:
国内的 DNS 相比较来说污染是很严重的，可能会把 DNS 解析到错误的节点上去，而 HTTP-DNS 可以进行精准调度；另外可以有效防止劫持绕过运营商的 Local DNS，避免域名劫持，访问更流畅；0ms 解析延迟，通过热点域名与解析，缓存 DNS 解析结果；稳定可靠，解析更加快。
码率选择:
日常比较常见的直播码率有流畅、标清、高清，部分平台也提供了超清的播放码率。这涉及到直播转码的策略，提供多种码率让用户可以实际去选择。多种码率的适配对于客户端网络不稳定的情况可以降低延时，这能够让用户有更好的观看直播体验。
3.2、互动玩法与画面不同步
那么有没有在音视频内部传递消息的方法呢？答案是SEI。
补充增强信息（Supplemental Enhancement Information）是码流范畴里面的概念，提供了向视频码流中加入信息的办法，是H.264/H.265 视频压缩标准的特性之一。SEI 有基本的特征：

并不是解码过程的必须项；
有可能对解码过程（容错、纠错）有帮助；
集成在视频码流中；
这意味着视频编码器在输出视频码流的时候，可以不提供SEI信息 。同时我们也要清楚：视频传输过程、解封装、解码环节，都可能因为某种原因丢弃SEI 。

在视频内容的生成端、传输过程中，都可以插入SEI 信息。插入的信息，和其他视频内容一起经过传输链路到达了消费端。那么在SEI 中可以添加哪些信息呢？这里举几个例子，用户场景可以任意扩展：

传递编码器参数；
传递视频版权信息;
传递摄像头参数；
传递内容生成过程中的剪辑事件（引发场景切换）；
























结  论

线上购物的体验形式必将逐渐向成熟的线下场景靠近；而随着投入商用的 5G 网络普及以及未来 VR 、AR 等技术的逐渐成熟，线上购物体验将远远超越过去传统的超市货架式电商，向真正的"云逛街"逐渐接近。
进店沟通：
过去：商品详情页跳转售前客服阿里旺旺文字聊天："亲，有什么可以帮您？"
未来：商品详情页跳转客服视频直播："亲，这条裙子搭配外套更显瘦哦！"
选品比较：
过去：看李佳琦将套装口红 10 个色号涂满手臂作比较；
未来：线上 AR 试妆，自由选取 10 个色号看效果；
产品溯源：
过去：薇娅滔滔不绝 5 分钟详细讲解某品牌奶制品原产地品控质量；
未来：随时进店铺直播间观看牛奶工厂各环节实时生产情况；
双线融合：
过去：二三线城市用户定期前往一线城市顶级商圈"买买买"；
未来：通过 VR/AR 技术二三线用户在家即可逛完各大一线城市顶级商圈；
致  谢
XX老师在我完成本论文期间给予我无私的帮助和精心的指导。在此，特向他表示衷心的感谢……













参考文献

[1]  镇雄县国土资源局.镇雄县土地利用总体规划(1997-2010年) 
[2]  镇雄县国土资源局.镇雄县土地利用现状概况（2005-03-21）
[3] 《国务院关于深化改革严格土地管理的决定》述评 （2004-12-31） 
[4]  王小映.土地管理体制变革背后存在三大深层矛盾与摩擦.中国经济时报,2004 
[5]  S. Gabaldon、S. Lopez.《Integral Recycling of Ceramic Wastes by Development of Ceramic Tiles 》. 2004.  
【ISBN】:0-87849-946-6. p.2517-2520 
[6] Steven M. Frank. 《AGING BEHAVIOR OF A SODALITE BASED CERAMIC WASTE F》.2004. 【ISBN】:1-57498-209-5. p9







详细步骤

1.采集：PC用户通过相机摄像头 、移动手机用户通过移动设备摄像头采集视频画面和音频声音，IOS设备厂家和机型种类不多，
厂商单一，适配简单。Android设备由于厂商和机型种多，系统版本碎片化严重，倒是适配困难，很难统一适配，需要单独适配。
PC端和具体摄像头驱动相关，目前有成熟的解决方案OBS。

2.处理：当采集到画面后，主播需要对画面进行美颜、模糊、水印、合成等操作。IOS端游成熟的GPIIMAGE库进行处理，提供
多功能处理效果，还能根据库的算法扩充更丰富功能。Android平台有GPUImage的移植库（android-gpuimage），覆盖了
andorid上图形图像和多媒体图像的处理。

3.编码：编码主要有两个问题：1、硬件兼容问题处理。2.在高帧率、低码率和音质质量中找到平衡，IOS硬件的性能高兼容
性高，可以使用硬件编码，但是Android的硬件性能参差不齐，需要不同适配，推荐使用软件编码

4.推流和传输：数据传输会涉及很多节点，推流工具到服务端，从服务端的流服务到中心节点，从中心节点到边缘节点，从
边缘节点到观众app端。推流端和cdn分发端都需要支持高并发访问，但是主播的推流端数量少，和观众端的播放器不是一个
量级，主播端的推流对于推流稳定性和推流速度的要求比观众播放端的拉流高很多，推流的质量涉及到所有观众端能付看到
直播，已经直播画面的质量。借助稳定的CDN能实现大规模的视频流分发，但是高速稳定的推流质量是需要自己做很多工作。

5.转码：各个平台播放使用不同的协议，为了兼容各个平台不同协议，需要主播端app推流到推流服务端之后进行一些流处理
工作，将推上来的流进行不同格式的转码，如rtmp、flv和m3u8，一路流转换成不同分辨的流来适应不同的网络环境和设备

6.解码和渲染：解码和渲染，就是视频和音频的播放，ios 的播放器硬件和软件版本少，兼容性好，在延迟方面要求不高的情况
下使用hls是最好的选择，Android的硬件和软件繁多，最好的开源播放器是基于ijkplayer和ffplay。如果对于实时性要求
高的情况下可以使用rtmp协议。

7.直播场景：直播间互动系统（弹幕、礼物、商品上架、点赞、连麦、发券、抽奖），通过消息通道的长连接服务，主播可以和用户实时
互动，通过实时互动，提升观众参与感，也能给观众带来商品最新信息。


------------------------------------------------------------------------------------------
2 、电商直播技术及内容现状和问题
2.1、电商直播玩法
（1）弹幕
聊天室、连麦、点赞、黑名单;

（2）礼物
直播间打赏、现金红包、内购、提现；

（3）直播列表
我的关注、热门推荐、最新活动、分类列表、主播列表；

（4）开播流程
采集、编码、推流、cdn分发、播放、主播中控台操作、运营管理操作；

（5）房间逻辑
创立直播间、进入直播间、退出直播间、关闭直播间、切换直播间、直播间管理员设置、直播间用户列表等；

（6）用户逻辑
普通登陆、注册、关注列表、搜索、修改个人信息、打榜列表、粉丝列表、忘记密码、查看个人信息、排行榜、关注和取关ßßßß；

（7）观看直播
聊天弹幕、礼物打赏、现金红包、抽奖等；

（8）统计
系统业务统计、播放器统计、第三方统计等；

（9）运营管理员
审核、屏蔽、屏蔽流、bannner位设置等；

------------------------------------------------------------------------------------------

2.2、直播延迟高
直播行业发展迅速，在日常生活中会看到各类直播，比如带货直播、吃货直播、发布会直播、秀场直播、在线教育。不管什么
类型直播，延时是所有直播中最棘手的问题。直播低延迟，是对直播产品最低的要求，低延迟也能带来更好的用户体验，特别是
互动性比较强的直播，比如互动直播和在线教育。但是目前普遍的产品还是存在直播延迟的现象。


2.3、互动玩法与画面不同步：
在直播的过程中，如果主播在主播中控台将消息通过长链接通道下发给观众端的时候，一般消息下发通道和直播视频通道是分开，
导致消息和直播音视频数据不同步的情况，用户体验大打折扣。


------------------------------------------------------------------------------------------












3 、如何降低直播延迟和玩法画面不同步的建议
3.1、降低直播延迟:
直播应用主要涉及到画面采集、数据编码、CDN推流、服务端转码、客户端解码流程。延迟会出现在以上所有环节，延迟时间
是每个环节的延迟总和。处理延迟是指主播端采集到画面数据包进行分析和将数据报文发送到服务端所产生的开销。传输延迟
是指将主播端的数据传输到服务端的时间。传输的时间会和直播画面的码率和帧率有关。传播延迟是从cdn边缘节点到用户端
收到数据的所产生的开销。传输延迟会受距离和速度影响。降低直播延迟有以下几种方式解决。

1、直播协议选择

目前行业中直播协议存在三种，RTMP、FLV、HLS，其中RTMP是流媒体专门的协议，对于流媒体底层优化优秀，比其他协议
支持更好，尤其是对Adobe Flash 支持更好，目前市面上所有采集器都支持RTMP的协议输出。PC端更多的还是采用FLASH
播放较多。RTMP时候长时间的播放，连续播放10天都没有问题。RTMP的延迟也是很低，延迟时间在1-3s之间，普通的视频
会议，带货直播，完全满足。

RTMP协议也不是完成没有问题，它也存在不足的地方。RTMP协议是基于TCP协议传输，不是公共端口，存在被防火墙拦截的可能；
RTMP是Adobe私有协议，在没有授权的情况下在设备上是没有办法播放的，需要单独的解码器进行协议解码之后才能播放。

HLS是苹果公司发布的流媒体传输协议，并且是基于HTTP协议。是苹果公司 QuickTime软件 和 ios设备上 软件系统的
一部分。主要应用于 iOS 终端设备，包含(iPhone,  iPod touch，iPad) 以及为 Mac OSX 苹果电脑提供音视频直播
服务和点播等服务。它的原理是将完整的流切分成多个小的文件来下载，基于http协议。当播放器正在播放时，播放器可以不同
的流媒体源地址，以不同的速率下载文件，流媒体会适配不同的传输速率。性能高，并且因为基于http协议，所以可以通过cdn
网络进行分发。

HLS的缺点非常明显，HLS由于使用cdn分发，延迟比较高，实时性较差。HLS的延迟在10秒以上。因为HLS访问请求不是完整的
视频数据流，会出现很多碎片文件。切片的TS文件会有大量小文件存在服务器中，对于后期服务器的存储和移植带来麻烦。


FLV是一种在网络上传输的流媒体数据存储容器格式。而我们所说的 HTTP-FLV 即将流媒体数据封装成 FLV 格式，
然后通过 HTTP 协议传输给客户端。HTTP-FLV 能够好的穿透防火墙，它是基于 HTTP/80 传输，有效避免被防火
墙拦截。另外，它可以通过 HTTP 302 跳转灵活调度/负载均衡，支持使用 HTTPS 加密传输，也能够兼容支持 
Android，iOS 的移动端。FLV 也有一个缺点，由于它的传输特性，会让流媒体资源缓存在本地客户端，在保密性
方面不够好。

在不同的直播场景中，选用合适的直播协议，能大大降低直播的延迟。









2、细节优化，减少延迟
智能调度:
国内的 DNS 相比较来说污染是很严重的，可能会把 DNS 解析到错误的节点上去，而 HTTP-DNS 可以进行精准调度；
另外可以有效防止劫持绕过运营商的 Local DNS，避免域名劫持，访问更流畅；0ms 解析延迟，通过热点域名与解析，
缓存 DNS 解析结果；稳定可靠，解析更加快。
码率选择:
日常比较常见的直播码率有流畅、标清、高清，部分平台也提供了超清的播放码率。这涉及到直播转码的策略，提供多种
码率让用户可以实际去选择。多种码率的适配对于客户端网络不稳定的情况可以降低延时，这能够让用户有更好的观看直
播体验。

3.2、互动玩法与画面不同步
那么有没有在音视频内部传递消息的方法呢？答案是SEI。
补充增强信息（Supplemental Enhancement Information）是码流范畴里面的概念，提供了向视频码流中加入信息
的办法，是H.264/H.265 视频压缩标准的特性之一。SEI 有基本的特征：

并不是解码过程的必须项；
有可能对解码过程（容错、纠错）有帮助；
集成在视频码流中；
这意味着视频编码器在输出视频码流的时候，可以不提供SEI信息 。同时我们也要清楚：视频传输过程、解封装、解码环
节，都可能因为某种原因丢弃SEI 。

在视频内容的生成端、传输过程中，都可以插入SEI 信息。插入的信息，和其他视频内容一起经过传输链路到达了消费端。
那么在SEI 中可以添加哪些信息呢？这里举几个例子，用户场景可以任意扩展：

传递编码器参数；
传递视频版权信息;
传递摄像头参数；
传递内容生成过程中的剪辑事件（引发场景切换）；


















------------------------------------------------------------------------------------------


结  论

线上购物的体验形式必将逐渐向成熟的线下场景靠近；而随着投入商用的 5G 网络普及以及未来 VR 、AR 等技术的逐渐成熟，线上购物体验将远远超越过去传统的超市货架式电商，向真正的"云逛街"逐渐接近。
进店沟通：
过去：商品详情页跳转售前客服阿里旺旺文字聊天："亲，有什么可以帮您？"
未来：商品详情页跳转客服视频直播："亲，这条裙子搭配外套更显瘦哦！"
选品比较：
过去：看李佳琦将套装口红 10 个色号涂满手臂作比较；
未来：线上 AR 试妆，自由选取 10 个色号看效果；
产品溯源：
过去：薇娅滔滔不绝 5 分钟详细讲解某品牌奶制品原产地品控质量；
未来：随时进店铺直播间观看牛奶工厂各环节实时生产情况；
双线融合：
过去：二三线城市用户定期前往一线城市顶级商圈"买买买"；
未来：通过 VR/AR 技术二三线用户在家即可逛完各大一线城市顶级商圈；


